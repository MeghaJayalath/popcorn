import React, { useEffect, useState } from 'react';

interface SplashScreenProps {
    isReady: boolean;
    onComplete: () => void;
}

const SplashScreen: React.FC<SplashScreenProps> = ({ isReady, onComplete }) => {
    const [minTimeElapsed, setMinTimeElapsed] = useState(false);
    const [isVisible, setIsVisible] = useState(true);
    const [fillLogo, setFillLogo] = useState(false);

    useEffect(() => {
        // Minimum time to show splash (e.g. 2s)
        const timeout = setTimeout(() => {
            setMinTimeElapsed(true);
            setFillLogo(true); // Trigger fill after drawing
        }, 2000);
        return () => clearTimeout(timeout);
    }, []);

    useEffect(() => {
        // Only start fade out when both data is ready AND min time elapsed
        if (isReady && minTimeElapsed) {
            // Wait a bit for the fill animation to be enjoyed
            const exitDelay = setTimeout(() => {
                setIsVisible(false);
                const t = setTimeout(onComplete, 500); // Wait for transition
                return () => clearTimeout(t);
            }, 1200);
            return () => clearTimeout(exitDelay);
        }
    }, [isReady, minTimeElapsed, onComplete]);

    return (
        <div style={{
            position: 'fixed', inset: 0,
            backgroundColor: '#000',
            zIndex: 9999,
            display: 'flex', flexDirection: 'column',
            alignItems: 'center', justifyContent: 'center',
            opacity: isVisible ? 1 : 0,
            transition: 'opacity 0.5s ease-in-out',
            pointerEvents: 'none'
        }}>
            <div style={{ position: 'relative', width: '300px', height: '300px' }}>
                <svg
                    viewBox="0 0 87.698227 44.908371"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    style={{
                        width: '100%',
                        height: '100%',
                        filter: 'drop-shadow(0 0 20px rgba(242, 180, 140, 0.35))'
                    }}
                >
                    <g transform="translate(-61.821707,-127.98417)">
                        <path
                            d="m 71.484686,172.64451 c -0.167485,-0.16749 -0.304949,-0.37346 -0.305473,-0.45771 -5.25e-4,-0.0843 -0.07809,-0.73853 -0.17237,-1.45395 -0.09428,-0.71541 -0.279348,-2.31179 -0.411267,-3.54751 -0.131919,-1.23572 -0.397605,-3.6569 -0.590415,-5.3804 -0.609808,-5.45103 -1.426506,-14.21467 -1.426506,-15.30725 0,-1.0769 -1.123242,-0.26347 -3.896905,2.82208 -1.807817,2.01109 -2.249633,2.20699 -2.676011,1.18652 -0.612076,-1.4649 0.258227,-2.88091 3.281088,-5.33845 7.457883,-6.06313 14.586228,-6.74021 17.412649,-1.65394 2.89851,5.216 -0.553872,11.73088 -8.563767,16.1604 -0.617462,0.34146 -1.132981,0.62941 -1.145597,0.6399 -0.02135,0.0177 0.171803,1.35937 0.784945,5.45213 0.38107,2.54367 0.577878,3.68085 0.854366,4.93663 0.299675,1.36109 0.256971,1.46142 -0.788565,1.8526 -1.110012,0.41531 -1.996349,0.44877 -2.356172,0.089 z m 2.269443,-14.82123 c 8.080209,-4.88112 9.672109,-14.10988 2.641815,-15.31544 -1.696548,-0.29093 -5.508666,0.81911 -5.282173,1.53809 0.03444,0.10934 0.143648,1.13002 0.242676,2.26819 0.271704,3.12277 1.146244,10.99147 1.310972,11.79549 0.07038,0.34351 0.02372,0.3558 1.08671,-0.28633 z m 23.917005,11.89092 c -0.63393,-0.13231 -0.79882,-0.43284 -0.88466,-1.61241 -0.36772,-5.05323 -1.59562,-13.39189 -1.97201,-13.39189 -0.0537,0 -0.19953,0.19955 -0.32407,0.44344 -0.26293,0.51492 -1.44727,1.68188 -1.9937,1.96445 -0.40323,0.20852 -0.43073,0.29279 -0.56479,1.73088 -0.49774,5.3392 -5.49294,7.75834 -7.567303,3.66478 -1.31476,-2.59455 -1.028179,-7.2888 0.54076,-8.85774 0.190642,-0.19064 0.346621,-0.44669 0.346621,-0.569 0,-0.8174 1.043028,-1.99575 2.133235,-2.41 2.336331,-0.88773 3.914999,0.72916 4.547087,4.65718 0.13152,0.81733 1.291,-0.19114 2.04484,-1.77851 0.471,-0.99178 0.4017,-1.51839 -0.6443,-4.89617 -0.48177,-1.55576 -0.47305,-1.64867 0.1862,-1.985 1.49024,-0.76026 2.37391,-0.0738 2.79508,2.17114 0.12315,0.65646 0.22195,0.60802 0.68953,-0.33807 1.41143,-2.85583 4.416466,-3.89174 6.180886,-2.1307 3.62723,3.62029 1.16122,12.24231 -3.594436,12.56736 -1.5814,0.1081 -1.83959,-1.33175 -0.28261,-1.57602 2.789686,-0.43767 4.382876,-6.33195 2.340276,-8.65834 -1.36937,-1.55963 -2.998236,-0.66403 -3.923376,2.15718 -0.58179,1.77415 -0.59852,2.062 -0.25082,4.31615 0.16552,1.07312 0.51868,3.38787 0.78478,5.1439 0.26611,1.75602 0.63784,4.15059 0.82607,5.32127 0.54273,3.37548 0.53743,3.28539 0.21515,3.66006 -0.31765,0.36929 -0.99516,0.53823 -1.62844,0.40606 z m -9.2666,-7.39404 c 0.749664,-0.35573 1.307669,-1.53785 1.572508,-3.33131 0.160551,-1.08723 0.196354,-1.04648 -0.973234,-1.10787 -1.203313,-0.0632 -1.919286,-0.37568 -2.705888,-1.18112 -0.641071,-0.65642 -0.691186,-0.6125 -0.691186,0.60574 0,3.28436 1.348938,5.70209 2.7978,5.01456 z m 1.598435,-6.42775 c -0.260153,-2.8215 -1.436464,-4.50778 -2.442639,-3.5016 -0.968353,0.96835 -0.130639,3.23435 1.399152,3.78467 0.806489,0.29012 1.089264,0.21341 1.043487,-0.28307 z m 19.253871,-1.41369 c -5.41277,-1.07315 -4.14003,-13.17913 1.4279,-13.58188 1.73629,-0.12559 3.00892,2.57404 2.11797,4.49284 -0.58196,1.25336 -2.11974,0.537 -1.8232,-0.84932 0.56269,-2.63059 -0.76545,-3.05006 -2.04125,-0.64469 -1.8336,3.45704 -0.83268,8.56747 1.67801,8.56747 2.40087,0 4.44039,-3.29725 4.49837,-7.2724 0.0392,-2.68599 0.45927,-4.30399 1.35804,-5.23053 0.17459,-0.17999 0.35365,-0.52346 0.39791,-0.76326 0.29353,-1.59046 2.53158,-2.86379 4.02862,-2.29207 1.16783,0.446 2.13201,1.99496 2.47612,3.97789 0.21006,1.2105 0.17619,1.1942 0.95371,0.45886 1.02961,-0.97377 1.41349,-1.86546 1.4644,-3.40154 0.0584,-1.76246 0.0111,-1.92706 -0.62896,-2.19021 -1.67965,-0.69053 -1.35722,-4.33533 0.38351,-4.33533 0.66519,0 1.32441,0.98237 1.33,1.98196 0.003,0.51729 0.11546,0.58339 1.23982,0.72798 3.02989,0.38966 3.33642,0.78568 3.48565,4.50334 0.0761,1.89482 0.12391,2.27136 0.35749,2.81317 0.97346,2.25798 2.99086,-0.13783 3.66329,-4.35043 0.13148,-0.82369 0.11592,-1.02583 -0.21845,-2.83707 -0.4129,-2.23664 -0.4299,-2.1512 0.58821,-2.95597 1.19118,-0.94157 1.37065,-0.7789 1.6042,1.45398 0.18935,1.81031 0.3211,2.50148 0.42139,2.21055 0.0336,-0.0975 0.22061,-0.8472 0.41551,-1.66589 1.6518,-6.93858 5.94002,-7.12761 6.47097,-0.28524 0.41681,5.37141 2.46782,4.46813 3.44291,-1.51628 0.37589,-2.30691 1.42563,-2.03511 1.1139,0.28841 -1.05198,7.84118 -6.19519,9.90072 -6.75758,2.706 -0.24327,-3.11214 -0.59798,-3.83889 -1.59956,-3.27726 -1.1704,0.65628 -2.3422,4.74702 -2.46307,8.59854 -0.0697,2.22239 -2.02883,3.44999 -2.26904,1.42182 -0.0922,-0.77808 -0.13535,-0.75554 -0.65444,0.34147 -1.45871,3.08269 -4.37343,3.90066 -5.67095,1.59146 -0.45095,-0.80257 -0.64619,-1.82855 -0.79163,-4.16015 -0.15618,-2.50357 -0.40341,-2.94812 -1.76022,-3.16508 -0.50197,-0.0803 -0.50197,-0.0803 -0.50211,1.26516 -3.7e-4,3.44136 -0.49158,5.47731 -1.1602,4.80869 -0.11235,-0.11235 -0.2223,-0.0477 -0.50796,0.2989 -0.20051,0.24325 -0.67053,0.65006 -1.04449,0.90401 -0.67992,0.46172 -0.67992,0.46172 -0.75498,1.50442 -0.36285,5.0406 -4.65744,8.01876 -7.03821,4.88079 -0.43428,-0.5724 -0.60957,-0.69883 -0.60957,-0.43966 0,0.31497 -1.03306,2.27907 -1.57835,3.00083 -1.27126,1.68267 -3.4581,2.73008 -5.04368,2.41572 z m 10.89113,-6.06899 c 0.72773,-0.48791 1.30681,-1.96154 1.4276,-3.63287 0.0384,-0.53213 0.0384,-0.53213 -0.95194,-0.6142 -1.24761,-0.10338 -2.05103,-0.47685 -2.78718,-1.29562 -0.66857,-0.74362 -0.71839,-0.65787 -0.61868,1.06478 0.19997,3.45451 1.49799,5.43815 2.9302,4.47791 z m 1.36277,-5.85188 c 0.30151,-0.19663 -0.29116,-2.80576 -0.81334,-3.58063 -0.95217,-1.41292 -2.3587,-0.18101 -1.80462,1.58056 0.37216,1.18321 1.15797,1.85596 2.42562,2.07665 0.0325,0.006 0.11907,-0.0288 0.19234,-0.0766 z"
                            stroke="#FDEDAD"
                            strokeWidth="0.5"
                            strokeLinecap="round"
                            strokeLinejoin="round"
                            style={{
                                fill: fillLogo ? '#FDEDAD' : 'transparent',
                                transition: 'fill 1s ease-in-out',
                                strokeDasharray: 2000,
                                strokeDashoffset: 0,
                                animation: 'draw 2s ease-in-out forwards'
                            }}
                        />
                    </g>
                </svg>
            </div>

            <style>{`
                @keyframes draw {
                    0% { stroke-dashoffset: 100; }
                    100% { stroke-dashoffset: 0; }
                }
            `}</style>
        </div>
    );
};

export default SplashScreen;
